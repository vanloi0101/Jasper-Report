{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vanlo\\\\all\\\\thuc tap\\\\asm2\\\\jasperreports\\\\src\\\\components\\\\ReportDownloader.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport './ReportDownloader.css';\n\n// Định nghĩa kiểu dữ liệu cho props (nếu có)\n\n// Định nghĩa kiểu cho định dạng báo cáo\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReportDownloader = () => {\n  _s();\n  const [rollNumber, setRollNumber] = useState('');\n  const [format, setFormat] = useState('pdf');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const handleDownload = async () => {\n    if (!rollNumber) {\n      setError('Vui lòng nhập mã số học sinh');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await axios.get(`http://localhost:8080/api/v1/reports/student/${rollNumber}?format=${format}`, {\n        responseType: 'blob'\n      } // Để xử lý file nhị phân (PDF/XLSX)\n      );\n\n      // Tạo URL tạm thời để tải file\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', `student_report_${rollNumber}.${format}`);\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n      window.URL.revokeObjectURL(url); // Giải phóng bộ nhớ\n    } catch (err) {\n      setError('Không thể tải báo cáo. Vui lòng kiểm tra lại.');\n      console.error('Error downloading report:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"report-downloader\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"T\\u1EA3i B\\xE1o C\\xE1o H\\u1ECDc Sinh\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"rollNumber\",\n        children: \"M\\xE3 S\\u1ED1 H\\u1ECDc Sinh:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"rollNumber\",\n        type: \"number\",\n        value: rollNumber,\n        onChange: e => setRollNumber(e.target.value ? parseInt(e.target.value) : ''),\n        placeholder: \"Nh\\u1EADp m\\xE3 s\\u1ED1 h\\u1ECDc sinh\",\n        disabled: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"format\",\n        children: \"\\u0110\\u1ECBnh D\\u1EA1ng B\\xE1o C\\xE1o:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"format\",\n        value: format,\n        onChange: e => setFormat(e.target.value),\n        disabled: loading,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"pdf\",\n          children: \"PDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"xlsx\",\n          children: \"XLSX\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleDownload,\n      disabled: loading,\n      children: loading ? 'Đang tải...' : 'Tải Báo Cáo'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n};\n_s(ReportDownloader, \"ajtab9/R7yUMPYrxwpkHg4HQenQ=\");\n_c = ReportDownloader;\nexport default ReportDownloader;\nvar _c;\n$RefreshReg$(_c, \"ReportDownloader\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","ReportDownloader","_s","rollNumber","setRollNumber","format","setFormat","loading","setLoading","error","setError","handleDownload","response","get","responseType","url","window","URL","createObjectURL","Blob","data","link","document","createElement","href","setAttribute","body","appendChild","click","remove","revokeObjectURL","err","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","id","type","value","onChange","e","target","parseInt","placeholder","disabled","onClick","_c","$RefreshReg$"],"sources":["C:/Users/vanlo/all/thuc tap/asm2/jasperreports/src/components/ReportDownloader.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport './ReportDownloader.css';\r\n\r\n// Định nghĩa kiểu dữ liệu cho props (nếu có)\r\ninterface ReportDownloaderProps {}\r\n\r\n// Định nghĩa kiểu cho định dạng báo cáo\r\ntype ReportFormat = 'pdf' | 'xlsx';\r\n\r\nconst ReportDownloader: React.FC<ReportDownloaderProps> = () => {\r\n  const [rollNumber, setRollNumber] = useState<number | ''>('');\r\n  const [format, setFormat] = useState<ReportFormat>('pdf');\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleDownload = async () => {\r\n    if (!rollNumber) {\r\n      setError('Vui lòng nhập mã số học sinh');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/v1/reports/student/${rollNumber}?format=${format}`,\r\n        { responseType: 'blob' } // Để xử lý file nhị phân (PDF/XLSX)\r\n      );\r\n\r\n      // Tạo URL tạm thời để tải file\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.setAttribute('download', `student_report_${rollNumber}.${format}`);\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n      window.URL.revokeObjectURL(url); // Giải phóng bộ nhớ\r\n    } catch (err) {\r\n      setError('Không thể tải báo cáo. Vui lòng kiểm tra lại.');\r\n      console.error('Error downloading report:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"report-downloader\">\r\n      <h2>Tải Báo Cáo Học Sinh</h2>\r\n      \r\n      <div className=\"form-group\">\r\n        <label htmlFor=\"rollNumber\">Mã Số Học Sinh:</label>\r\n        <input\r\n          id=\"rollNumber\"\r\n          type=\"number\"\r\n          value={rollNumber}\r\n          onChange={(e) => setRollNumber(e.target.value ? parseInt(e.target.value) : '')}\r\n          placeholder=\"Nhập mã số học sinh\"\r\n          disabled={loading}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label htmlFor=\"format\">Định Dạng Báo Cáo:</label>\r\n        <select\r\n          id=\"format\"\r\n          value={format}\r\n          onChange={(e) => setFormat(e.target.value as ReportFormat)}\r\n          disabled={loading}\r\n        >\r\n          <option value=\"pdf\">PDF</option>\r\n          <option value=\"xlsx\">XLSX</option>\r\n        </select>\r\n      </div>\r\n\r\n      {error && <p className=\"error-message\">{error}</p>}\r\n\r\n      <button onClick={handleDownload} disabled={loading}>\r\n        {loading ? 'Đang tải...' : 'Tải Báo Cáo'}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReportDownloader;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}